!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=13)}([function(t,e,r){t.exports=r(5)},function(t,e){t.exports=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}},function(t,e){function r(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}t.exports=function(t){return function(){var e=this,n=arguments;return new Promise((function(o,a){var i=t.apply(e,n);function c(t){r(i,o,a,c,u,"next",t)}function u(t){r(i,o,a,c,u,"throw",t)}c(void 0)}))}}},function(t,e,r){var n=r(10),o=r(11),a=r(12);t.exports=function(t){return n(t)||o(t)||a()}},function(t,e,r){var n=r(7),o=r(8),a=r(9);t.exports=function(t,e){return n(t)||o(t,e)||a()}},function(t,e,r){(function(t){function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r=function(t){"use strict";var r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r,n){var o=e&&e.prototype instanceof s?e:s,a=Object.create(o.prototype),i=new O(n||[]);return a._invoke=function(t,e,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return j()}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var c=x(i,r);if(c){if(c===l)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=f(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}(t,r,i),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var l={};function s(){}function p(){}function v(){}var h={};h[a]=function(){return this};var m=Object.getPrototypeOf,d=m&&m(m(P([])));d&&d!==r&&n.call(d,a)&&(h=d);var y=v.prototype=s.prototype=Object.create(h);function g(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function b(t){var r;this._invoke=function(o,a){function i(){return new Promise((function(r,i){!function r(o,a,i,c){var u=f(t[o],t,a);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"===e(s)&&n.call(s,"__await")?Promise.resolve(s.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):Promise.resolve(s).then((function(t){l.value=t,i(l)}),(function(t){return r("throw",t,i,c)}))}c(u.arg)}(o,a,r,i)}))}return r=r?r.then(i,i):i()}}function x(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,x(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=f(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,l;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function w(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function P(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return p.prototype=y.constructor=v,v.constructor=p,v[c]=p.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c in t||(t[c]="GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},g(b.prototype),b.prototype[i]=function(){return this},t.AsyncIterator=b,t.async=function(e,r,n,o){var a=new b(u(e,r,n,o));return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},g(y),y[c]="Generator",y[a]=function(){return this},y.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,l):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),w(r),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;w(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},t}("object"===e(t)?t.exports:{});try{regeneratorRuntime=r}catch(t){Function("r","regeneratorRuntime = r")(r)}}).call(this,r(6)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var r=[],n=!0,o=!1,a=void 0;try{for(var i,c=t[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!e||r.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==c.return||c.return()}finally{if(o)throw a}}return r}}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(t,e){t.exports=function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}},function(t,e){t.exports=function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(t,e,r){"use strict";r.r(e);var n=r(0),o=r.n(n),a=r(1),i=r.n(a),c=r(2),u=r.n(c),f=function(t){return"\nprecision mediump float;\n\nvarying highp vec3 vMaterial;\n\n".concat(t?t.map((function(t){var e=t.name;return t.glTexture?"uniform sampler2D ".concat(e,";"):null})).join("\n"):"","\n\nvarying highp vec3 vLighting;\n\nvec4 color = vec4(1.0, 1.0, 1.0, 1.0);\n\nvoid main() {\n  ").concat(t?t.map((function(t){var e=t.id,r=t.name,n=t.Kd,o=t.glTexture,a="if(vMaterial[2] == ".concat(e,".0) {\n");return a=o?"".concat(a,"    color = texture2D(").concat(r,", vec2(vMaterial.x, vMaterial.y));"):n?"".concat(a,"    color = vec4(vec3(").concat(n.join(", "),"), 1.0);"):"".concat(a,"    color = vec4(1, 0, 1, 1);"),"".concat(a,"  \n  }")})).join("\n  else "):"","\n\n  gl_FragColor = vec4(color.rgb * vLighting, 1.0);\n}\n")},l=function(t,e,r){var n=t.createShader(e);return t.shaderSource(n,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(alert("An error occurred compiling the shaders: "+t.getShaderInfoLog(n)),t.deleteShader(n),null)},s=function(t,e){var r=l(t,t.VERTEX_SHADER,"\nattribute vec4 aVertexPosition;\nattribute vec3 aVertextMaterial;\nattribute vec3 aVertexNormal;\n\nuniform mat4 uProjectionMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uNormalMatrix;\n\nuniform vec3 ulightVector;\n\nvarying highp vec3 vMaterial;\nvarying highp vec3 vLighting;\n\nvoid main() {\n  gl_Position = uProjectionMatrix * uModelViewMatrix * aVertexPosition;\n  vMaterial = aVertextMaterial;\n\n\n  highp vec3 ambientLight = vec3(0.2, 0.2, 0.2);\n  highp vec3 directionalLightColor = vec3(1, 1, 1);\n  highp vec3 directionalVector = normalize(ulightVector);\n  // highp vec3 directionalVector = normalize(vec3(0.8, 0.8, 1));\n  highp vec4 transformedNormal = uNormalMatrix * vec4(aVertexNormal, 1.0);\n  highp float directional = max(dot(transformedNormal.xyz, directionalVector), 0.0);\n  vLighting = ambientLight + (directionalLightColor * directional);\n}\n"),n=l(t,t.FRAGMENT_SHADER,f(e)),o=t.createProgram();return t.attachShader(o,r),t.attachShader(o,n),t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)?o:(console.error("Unable to initialize the shader program: ".concat(t.getProgramInfoLog(o))),null)},p=r(4),v=r.n(p),h=function(){var t=u()(o.a.mark((function t(e){var r,n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:return r=t.sent,t.next=5,r.text();case 5:return n=t.sent,t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),m=r(3),d=r.n(m),y=function(t,e,r){var n=new Array(3*r);return t.forEach((function(t,r){for(var o=function(t,e,r){var n=e.x-t.x,o=e.y-t.y,a=e.z-t.z,i=r.x-t.x,c=r.y-t.y,u=r.z-t.z,f=o*u-a*c,l=a*i-n*u,s=n*c-o*i,p=Math.sqrt(f*f+l*l+s*s);return 0===p&&(p=1),{x:f/p,y:l/p,z:s/p}}({x:e[t[0].v][0],y:e[t[0].v][1],z:e[t[0].v][2]},{x:e[t[1].v][0],y:e[t[1].v][1],z:e[t[1].v][2]},{x:e[t[2].v][0],y:e[t[2].v][1],z:e[t[2].v][2]}),a=0;a<3;a+=1)t[0+a].vn=r,n[3*r]=o.x,n[3*r+1]=o.y,n[3*r+2]=o.z})),n},g=function(t,e){var r=[],n=[];return t.forEach((function(o){o.forEach((function(o){var a=o.v;if(!n.includes(a)){n.push(a);for(var i=function(t,e){return e.filter((function(e){return e[0].v===t||e[1].v===t||e[2].v===t}))}(a,t),c=i.length,u=[e[3*i[0][0].vn],e[3*i[0][0].vn+1],e[3*i[0][0].vn+2]],f=1;f<c;f+=1)u[0]+=e[3*i[f][0].vn],u[1]+=e[3*i[f][0].vn+1],u[2]+=e[3*i[f][0].vn+2];u=u.map((function(t){return t/c})),r.push.apply(r,d()(u));var l=r.length/3-1;i.forEach((function(t){t.find((function(t){return t.v===a})).vn=l}))}}))})),r},b=function(t){var e,r=t.faces,n=t.positions,o=t.textures,a=t.normals,i=t.vertexNormals,c={},u=r.length;if(a.length)e=a.reduce((function(t,e){return t.push.apply(t,d()(e)),t}),[]);else{for(var f=[],l=0;l<r.length;l+=3)f.push([r[l],r[l+1],r[l+2]]);e=y(f,n,u),console.log({facesCombined:f,inNormals:e}),i&&(e=g(f,e))}var s=[],p=[],v=[],h=[],m=0;r.forEach((function(t){var r=t.v,a=t.vt,i=t.vn,u=t.m,f=function(t){var e=t.v,r=t.vt,n=t.vn,o=t.m;return"".concat(e,"_").concat(r,"_").concat(n,"_").concat(o)}(t),l=c[f];void 0!==l?s.push(l):(s.push(m),p.push.apply(p,d()(n[r])),void 0!==a&&v.push.apply(v,d()(o[a]).concat([u])),void 0!==i&&h.push(e[3*i],e[3*i+1],e[3*i+2]),c[f]=m,m+=1)}));var b=s.length;return{faces:s,facesCount:b,positions:p,materials:v,normals:h}};function x(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}var E=/^usemtl\s+(.*)/,w=/^v\s+([\d\.\+\-eE]+)\s+([\d\.\+\-eE]+)\s+([\d\.\+\-eE]+)/,O=/^vt\s+([\d\.\+\-eE]+)\s+([\d\.\+\-eE]+)/,P=/^vn\s+([\d\.\+\-eE]+)\s+([\d\.\+\-eE]+)\s+([\d\.\+\-eE]+)/,j=/^f\s+(\d+)\/(\d+)\/{0,1}(\d*){0,1}\s+(\d+)\/(\d+)\/{0,1}(\d*){0,1}\s+(\d+)\/(\d+)\/{0,1}(\d*){0,1}/,T=function(t){return[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])]},_=function(t){return t?parseInt(t,10)-1:void 0},A=function(t,e){return t.map((function(t){return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?x(Object(r),!0).forEach((function(e){i()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t,{m:e})}))},L=function(t){var e,r=t.text,n=t.mtlData,o=t.vertexNormals,a=r.split("\n"),i=[],c=[],u=[],f=[],l=[],s=[],p=0;return a.forEach((function(t){if(n){var r=E.exec(t)||[null,null],o=v()(r,2)[1];if(o){var a=l.indexOf(o);return void(a>-1?p=a:(l.push(o),p=l.length-1))}}if(e=w.exec(t))i.push(T(e));else if(e=P.exec(t))c.push(T(e));else if(e=O.exec(t))u.push(function(t){return[parseFloat(t[1]),parseFloat(t[2])]}(e));else if(e=j.exec(t)){var h=function(t){return[{v:_(t[1]),vt:_(t[2]),vn:_(t[3])},{v:_(t[4]),vt:_(t[5]),vn:_(t[6])},{v:_(t[7]),vt:_(t[8]),vn:_(t[9])}]}(e);f.push.apply(f,d()(h)),s.push.apply(s,d()(A(h,p)))}})),b({faces:s,positions:i,textures:u,normals:c,vertexNormals:o})},R=/^newmtl\s+(.*)/,D=/^map_Kd\s+(.*)/,F=/^(Ka|Kd|Ks)\s+([0-9]*\.?[0-9]+)\s+([0-9]*\.?[0-9]+)\s+([0-9]*\.?[0-9]+)/,S=function(t){var e,r,n,o,a,i,c=t.split("\n"),u={},f=null,l=0;return c.forEach((function(t){var c=R.exec(t)||[null,null],s=v()(c,2);if(e=s[1])return u[f=e]={id:l},void(l+=1);var p=F.exec(t)||[null,null,null,null],h=v()(p,5);r=h[1],n=h[2],o=h[3],a=h[4],r&&(u[f][r]=[parseFloat(n),parseFloat(o),parseFloat(a)]);var m=D.exec(t)||[null,null],d=v()(m,2);(i=d[1])&&(u[f].map_Kd=i)})),u},M=/^mtllib\s+(.*)$/m,N=function(){var t=u()(o.a.mark((function t(e){var r,n,a,i,c,u,f,l,s,p,m;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.filename,n=e.basePath,a=e.vertexNormals,t.next=3,h("".concat(n,"/").concat(r));case 3:if(i=t.sent,c=null,u=M.exec(i)||[null,null],f=v()(u,2),l=f[1],!(s=void 0===l?null:l)){t.next=13;break}return t.next=9,h("".concat(n,"/").concat(s));case 9:p=t.sent,c=S(p),t.next=14;break;case 13:console.info("No associated mtl file defined");case 14:return m=L({text:i,mtlData:c,vertexNormals:a}),t.abrupt("return",{objData:m,mtlData:c});case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function U(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}var B=function(t){var e=t.texture,r=t.basePath;return new Promise((function(t,n){var o=new Image;o.src="".concat(r,"/").concat(e.map_Kd),o.onload=function(){return t(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?U(Object(r),!0).forEach((function(e){i()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},e,{image:o}))},o.onerror=function(){return n()}}))};function k(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function I(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?k(Object(r),!0).forEach((function(e){i()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var V=function(){var t=u()(o.a.mark((function t(e){var r,n,a,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.mtlData,n=e.basePath,a=Object.keys(r).map(function(){var t=u()(o.a.mark((function t(e){var a,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r[e].map_Kd,i=I({name:e},r[e]),a){t.next=4;break}return t.abrupt("return",new Promise((function(t){return t(i)})));case 4:return t.abrupt("return",B({texture:i,basePath:n}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=4,Promise.all(a);case 4:return i=t.sent,t.abrupt("return",i);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function C(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}var z=function(t){return function(e){if(!e.image)return e;var r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),"grass"===e.name?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e.image),function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?C(Object(r),!0).forEach((function(e){i()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},e,{glTexture:r})}},G=function(t,e){return e.map(z(t))},X=function(t,e){var r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e.positions),t.STATIC_DRAW);var n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e.materials),t.STATIC_DRAW);var o=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e.normals),t.STATIC_DRAW);var a=t.createBuffer();return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,a),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(e.faces),t.STATIC_DRAW),{indexBuffer:a,indexCount:e.facesCount,positionBuffer:r,materialBuffer:n,normalBuffer:o}},Y=vec3.fromValues(0,0,1),W=function(t){var e=t.gl,r=t.programInfo,n=t.buffers,o=t.glTextureData,a=t.settings,i=t.state;e.clearColor(.3,.7,1,1),e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var c=45*Math.PI/180,u=e.canvas.clientWidth/e.canvas.clientHeight,f=a.zFar,l=mat4.create();mat4.perspective(l,c,u,.1,f);var s=mat4.create();mat4.translate(s,s,a.translate),mat4.translate(s,s,[0,0,i.move]),mat4.rotate(s,s,i.rotation,[0,1,0]);var p=e.FLOAT;e.bindBuffer(e.ARRAY_BUFFER,n.positionBuffer),e.vertexAttribPointer(r.attribLocations.vertexPosition,3,p,!1,0,0),e.enableVertexAttribArray(r.attribLocations.vertexPosition);var v=e.FLOAT;e.bindBuffer(e.ARRAY_BUFFER,n.materialBuffer),e.vertexAttribPointer(r.attribLocations.vertextMaterial,3,v,!1,0,0),e.enableVertexAttribArray(r.attribLocations.vertextMaterial);var h=mat4.create();mat4.invert(h,s),mat4.transpose(h,h);var m=e.FLOAT;e.bindBuffer(e.ARRAY_BUFFER,n.normalBuffer),e.vertexAttribPointer(r.attribLocations.vertextNormal,3,m,!1,0,0),e.enableVertexAttribArray(r.attribLocations.vertextNormal),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n.indexBuffer),e.useProgram(r.program),e.uniformMatrix4fv(r.uniformLocations.projectionMatrix,!1,l),e.uniformMatrix4fv(r.uniformLocations.modelViewMatrix,!1,s),e.uniformMatrix4fv(r.uniformLocations.normalMatrix,!1,h);var d=vec3.fromValues(0,0,0);vec3.rotateY(Y,Y,d,i.deltaTime),e.uniform3fv(r.uniformLocations.lightVector,Y),o&&o.forEach((function(t){var n=t.name,o=t.id,a=t.glTexture;e.activeTexture(e["TEXTURE".concat(o)]),e.bindTexture(e.TEXTURE_2D,a),e.uniform1i(r.uniformLocations[n],o)}));var y=e.UNSIGNED_SHORT,g=n.indexCount;e.drawElements(e.TRIANGLES,g,y,0)},K=function(t){var e=0,r=0,n=0;document.addEventListener("keydown",(function(t){t.isComposing||(37===t.keyCode?r-=.1:39===t.keyCode&&(r+=.1),38===t.keyCode?n+=10:40===t.keyCode&&(n-=10))}));requestAnimationFrame((function o(a){var i=.001*a,c=i-e;e=i,t({deltaTime:c,rotation:r,move:n}),requestAnimationFrame(o)}))};function q(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function H(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?q(Object(r),!0).forEach((function(e){i()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var Q=[{queryParam:"peacock",file:{basePath:"resources",filename:"Peacock_World4.obj"},zFar:800,translate:[0,-50,-200],rotate:!1},{queryParam:"color",file:{basePath:"resources",filename:"deer.obj"},zFar:1e4,translate:[-0,-500,-3e3],rotate:!0},{queryParam:"vertexNormals",file:{basePath:"resources",filename:"deer_no_normals.obj"},zFar:1e4,translate:[-0,-500,-3e3],rotate:!0,vertexNormals:!0},{queryParam:"faceNormals",file:{basePath:"resources",filename:"deer_no_normals.obj"},zFar:1e4,translate:[-0,-500,-3e3],rotate:!0}],$=function(t){var e=t.gl,r=t.objData,n=t.textureData,o=t.settings,a=n?G(e,n):null;console.log({glTextureData:a});var i=s(e,a),c={program:i,attribLocations:{vertexPosition:e.getAttribLocation(i,"aVertexPosition"),vertextMaterial:e.getAttribLocation(i,"aVertextMaterial"),vertexNormal:e.getAttribLocation(i,"aVertexNormal")},uniformLocations:{projectionMatrix:e.getUniformLocation(i,"uProjectionMatrix"),viewMatrix:e.getUniformLocation(i,"uViewMatrix"),modelViewMatrix:e.getUniformLocation(i,"uModelViewMatrix"),normalMatrix:e.getUniformLocation(i,"uNormalMatrix"),lightVector:e.getUniformLocation(i,"ulightVector")}};a&&a.forEach((function(t){c.uniformLocations[t.name]=e.getUniformLocation(i,t.name)})),console.log({programInfo:c});var u=X(e,r);K((function(t){return W({gl:e,programInfo:c,buffers:u,glTextureData:a,settings:o,state:t})}))},J=function(t){var e=document.getElementById(t),r=e.getContext("webgl");return r||(e.replaceWith("Browser does not support WebGL"),null)},Z=function(){var t=u()(o.a.mark((function t(){var e,r,n,a,i,c,u,f;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=new URLSearchParams(window.location.search),r=e.get("m"),n=Q.find((function(t){return t.queryParam===r}))||Q[0],a=J("canvas")){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,N(H({},n.file,{vertexNormals:n.vertexNormals}));case 8:if(i=t.sent,c=i.objData,u=i.mtlData,console.log({objData:c}),console.log({mtlData:u}),!u){t.next=19;break}return t.next=16,V({mtlData:u,basePath:n.file.basePath});case 16:t.t0=t.sent,t.next=20;break;case 19:t.t0=null;case 20:f=t.t0,console.log({textureData:f}),$({gl:a,objData:c,textureData:f,settings:n});case 23:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();window.onload=Z}]);
//# sourceMappingURL=bundle.js.map